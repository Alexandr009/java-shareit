-- Удаление таблиц, если они существуют
--DROP TABLE IF EXISTS booking CASCADE;
--DROP TABLE IF EXISTS item CASCADE;
--DROP TABLE IF EXISTS request CASCADE;
DROP TABLE IF EXISTS users CASCADE;

-- Создание таблицы users
CREATE TABLE IF NOT EXISTS users (
   id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
   email VARCHAR(100) NOT NULL UNIQUE,
    name VARCHAR(100) NOT NULL
    );

-- Создание таблицы request
CREATE TABLE IF NOT EXISTS request (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    description VARCHAR(100) NOT NULL,
    requestor INTEGER REFERENCES users (id) ON DELETE CASCADE,
    created TIMESTAMP NOT NULL
    );

-- Создание таблицы item
CREATE TABLE IF NOT EXISTS item (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    description VARCHAR(100) NOT NULL,
    available VARCHAR(100),
    owner INTEGER REFERENCES users (id) ON DELETE CASCADE
    --request_id INTEGER REFERENCES request (id) ON DELETE SET NULL
    );

-- Создание таблицы booking
CREATE TABLE IF NOT EXISTS booking (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    start_time TIMESTAMP NOT NULL,
    end_time TIMESTAMP NOT NULL,
    item_id INTEGER REFERENCES item (id) ON DELETE CASCADE,
    booker_id INTEGER REFERENCES users (id) ON DELETE CASCADE,
    status VARCHAR(100) NOT NULL
    );